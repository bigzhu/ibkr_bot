## 之前版本

git 51540646

| 月份    | 订单数 | 总利润 | 总手续费 | 到手利润 |
| ------- | ------ | ------ | -------- | -------- |
| 2025-11 | 778    | 326.19 | 429.61   | -103.42  |
| 2025-10 | 2048   | 774.65 | 1121.34  | -346.70  |

| 交易对  | 订单数 | 总利润  | 总手续费 | 到手利润 |
| ------- | ------ | ------- | -------- | -------- |
| SUIUSDC | 2826   | 1100.84 | 1550.95  | -450.12  |

## 回测让当前k线也会成交

git 1be3f64e

| 月份    | 订单数 | 总利润  | 总手续费 | 到手利润 |
| ------- | ------ | ------- | -------- | -------- |
| 2025-11 | 1098   | 12.81   | 550.82   | -538.01  |
| 2025-10 | 2914   | -109.75 | 1496.38  | -1606.13 |

| 交易对  | 订单数 | 总利润 | 总手续费 | 到手利润 |
| ------- | ------ | ------ | -------- | -------- |
| SUIUSDC | 4012   | -96.94 | 2047.20  | -2144.14 |

回测撮合: backtester/mock_client.py 新增 process_pending_orders_now, 允许在当前 tick 立即复用 \_process_pending_orders, 并在 backtester/engine.py:226-232 于 strategy.next() 后调用, 让同一根 K 线中新挂的 STOP 单能立刻按当根高低价成交, 修 复订单被延后一根才撮合的问题.

这个修改, 让回测呈现了真实状况, 整体都在亏损了

| 月份    | 订单数 | 总利润  | 总手续费 | 到手利润 |
| ------- | ------ | ------- | -------- | -------- |
| 2024-09 | 1235   | 496.24  | 617.00   | -120.76  |
| 2024-08 | 2849   | 1386.45 | 1463.98  | -77.54   |
| 2024-07 | 2985   | 859.57  | 1627.78  | -768.21  |
| 2024-06 | 2778   | 866.33  | 1504.89  | -638.55  |
| 2024-05 | 3024   | 1599.51 | 1705.47  | -105.96  |
| 2024-04 | 2983   | 2173.22 | 1671.83  | 501.39   |
| 2024-03 | 3097   | 2179.05 | 1727.30  | 451.75   |
| 2024-02 | 2883   | 1821.96 | 1584.11  | 237.85   |
| 2024-01 | 1199   | 995.58  | 668.11   | 327.48   |

年景比较好的 2024 年, 算上返佣还能覆盖手续费, 但是 2025 年就难以覆盖了

这个策略如果没有手续费的话, 还是可以继续优化的
